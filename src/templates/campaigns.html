{% extends "base_page.html" %}

{% block content %}
    <style>
        .campaign-image {
            max-width: 200px;
            border-radius: 20px;
        }
        .container-header{
            max-width: 960px;
            margin: auto;

        }
        .campaign-container{
            display: flex;
            flex-wrap: wrap;
            margin: auto;
            max-width: 960px;

        }
        .campaign-card{
            max-width: 210px;
            height: 300px;
            display: flex;
            flex-direction: column;
            padding: 1em;
        }
        .campaign-card p{
            margin-top: -5px;
        }
        .progress-bar {
            background-color: rgb(0,128,0,.2);
            height: 2px;
            width: 100%;
            border-radius: 3px;
            margin-bottom: 10px;
        }
        .bottom-pinned{
            margin-top: auto;
        }

        .progress {
            background-color: green;
            height: 100%;
            border-radius: 3px;
        }
        .campaign-title{
            font-weight: bold;
            height: 2em;
            font-size:medium;
        }
        .search{
            width: 100%;
        }

        @media only screen and (max-width: 1200px) {
            
        }

        @media only screen and (max-width: 768px) {
            
        }

        @media only screen and (max-width: 576px) {
            .campaign-card{
                max-width: 100%;
                height: 300px;
                display: flex;
                flex-direction: column;
                padding: 1em;
            }
            .campaign-image {
                max-width: 100%;
                border-radius: 20px;
            }
            
        }

        @media only screen and (max-width: 350px) {
        }
    </style>
    <div class="container">
        <div class="container-header">
            <button class="power-button" onclick="createNewCampaign()">Create a campaign</button>
            <h2>{{page_title}}</h2>
        </div>

        <div class="campaign-container">
            {% if form %}
            <div class="search">
                <form method="POST" action="#">
                    {{ form.csrf_token }}
                    <p>{{form.terms.label}}</p>
                    <p>{{form.terms(style="width:100%;")}}</p>
                    <p>{{form.submit(class="submit-button")}}</p>
                </form>
            </div>
            {% endif %}
            {%for campaign in campaigns%}
            <div class="campaign-card">
                <a style="text-decoration: none; color:inherit" href="{{url_for('get_campaign', campaign_id=campaign.id)}}">
                    <img class="campaign-image" src="{{url_for('get_campaign_image', campaign_id=campaign.id)}}"/>
                    <p class="campaign-title">{{campaign.title | truncate(27, True, '', 0)}}</p>
                    <div class="progress-bar bottom-pinned">
                        <div class="progress" style="width:{{campaign.progress}}%"></div>
                    </div>
                    <p><span style="font-weight: bold;">{{campaign.currency_symbol}} {{campaign.amount_reached}}</span> raised</p>
                </a>
            </div>
            {%endfor%}
        </div>
    </div>
    <script>
        function createNewCampaign(){
            window.open('{{url_for("create")}}');
        }
    </script>

{% endblock %}